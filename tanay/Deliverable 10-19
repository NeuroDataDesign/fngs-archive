Deliverables 10/19/16 – Tanay Agarwal

Notes on fMRI book:

•	fMRI = functional magnetic resonance imaging
•	Analysis of fMRI data is made complex by several factors:
  o	Head movement
  o	Source variability
  o	Large dimensionality
•	Major steps in fMRI analysis:
  o	Quality control
  o	Distortion correction
  o	Motion correction
  o	Slice timing correction
  o	Spatial normalization
  o	Spatial smoothing
  o	Temporal filtering
  o	Statistical modeling
  o	Statistical inference
  o	Visualization
•	Digital image = matrix of color values corresponding to spatial locations
•	Each element in image = voxel (3D analog to pixel)
•	fMRI data are represented as a time-series of 3D images (hence 4D)
•	Map data points in 3D matrix to spatial location by using x-y-z coordinate system
  o	X represents left-right dimension
  o	Y represents anterior-posterior dimension
  o	Z represents inferior-superior dimension
•	Native space = original coordinate system of image as acquired by MRI scanner
  o	Every image can have a different native space because it depends on how the head was positioned inside the scanner
•	Affine transformation = simplest transformation model – uses linear operators
  o	Any set of points that fell on a line prior to the transformation will continue to fall on a line after the transformation
  o	Involves combination of:
    	Translation
    	Rotation around axis
    	Scaling along axis
    	Shearing along axis
•	Nonlinear transformations allow more freedom; you can change some parts of an image more drastically than others
•	Cost function = way to define the differences between two images in order to pick best alignment method
  o	Should be small when images are aligned and larger as images get more misaligned
  o	Examples:
    	Least squares
    	Normalized correlation – appropriate for within-modality registration
    	Mutual information – arises from concept of entropy in information theory
      •	MI = H(A) + H(B) – H(A,B)
      •	Normalized: MI = ( H(A) + H(B) ) / H(A,B)
    	Correlation ratio
•	Fourier analysis = filtering and decomposing signal into components
•	Convolution = when a function is passed over another signal and their overlap is added up at each point
•	Scanner artifacts:
  o	Spikes = brief changes in brightness due to electrical instability
  o	Ghosting = slight offset in phase between different lines of K-space
•	Distortion correction:
  o	Used to deal with signal dropouts in data
  o	Primary method: field mapping
  o	High-pass filtering can accompany field mapping for smoother results
•	Slice timing correction:
  o	fMRI data acquired in slices one at a time -> leaves room for timing delay
  o	Correction applied to address the mismatch between acquisition timing of different slices
  o	Slice timing correction is being used less often nowadays because artifacts can be propagated through the time-series
•	Motion correction:
  o	Subjects move their heads inside the scanner (unavoidable)
  o	Correction works by realigning all images in the time-series to a single reference image
  o	Two types of motion – bulk and stimulus-correlated motion – have specific tell-tale artifacts
  o	Steps in correction:
    	Estimating motion
    	Choosing target
    	Choosing cost function
    	Creating realigned images
  o	Quality control is a must: running motion correction multiple times on the same dataset is strongly discouraged because it will degrade the data
•	Spatial smoothing:
  o	Filtering data to remove high-frequency signals – essentially blurring the image
  o	Increases signal-to-noise ratios
  o	Most common method is convolution of the 3D image using a 3D Gaussian filter
  o	Amount of smoothing applied depends on goal and task – general rule of thumb is to smooth too little rather than too much
•	Spatial normalization
  o	Used to align different subject scans to a common space for further analysis
  o	Common 3D space created based on brain landmarks
  o	Atlas = guide to the location of anatomical features in a coordinate space
  o	Template = image representative of atlas that can be used for alignment of other images
  o	Preprocessing of images required for spatial normalization:
    	Bias field correction
    	Brain extraction
    	Tissue segmentation
  o	Methods:
    	Landmark-based: align images based on anatomical brain landmarks
    	Volume-based: most commonly used today
    	Computational anatomy
  o	Quality control:
    	One useful step is to examine the normalized image with the outline of the template overlaid
    	Another useful step is to examine the average of the normalized brains -> average should look like a blurry real brain


Quality control examples:

Following are some explanations of why and how the quality control results produced by the fngs pipeline can be interpreted. The dataset tested was SWU_1, and the example subject used was 0027203 session 1. After reading the above notes and the following link (https://github.com/neurodata/ndmg/blob/eric-dev-merge/examples/fngs_qc.ipynb), it should be much easier to make sense of the quality control results.

Motion correction:
  •	Jitter plot:
    o	Shows that following motion correction, the average error was greatly reduced. This obviously suggests that our motion correction was successful.
  •	KDE plot:
    o	We can see that the average Hellinger distance error was greatly decreased and concentrated after motion correction. This is a good sign because before motion correction, the noise makes the error distribution very spread out.
  •	Overlaid images:
    o	Shows us all the corrected slices individually, allowing us to imagine a “movie”-style animation. By looking at the side-by-side images, we should be able to see that the brain itself doesn’t appear to move in space anymore post-correction.
Registration:
  •	Jitter plot:
    o	We see that the average slice-wise error is greatly reduced post-registration.
  •	KDE plot:
    o	Just like motion correction, we can see that the average Hellinger distance error was greatly decreased and concentrated after registration. Lower error density means registration was helpful and successful.
  •	Overlaid images:
    o	The slice-wise images here are overlaid with the atlas, allowing us to check the results of our registration qualitatively. Here, we can see that our slices have a relatively homogeneous coloring, suggesting that registration was successful!
ROI:
  •	Overlaid images:
    o	Here, we have two outputs, in which we are comparing the labelled ROI images to either the mean resting state fMRI or the reference atlas. This allows us to ensure that our label file is in the same space that our brain was registered to! This is critical when it comes time to extract the time-series. For our specific examples, we can see that our reference atlas maps up well with the label file. Our actual fMRIs also lines up perfectly, meaning we can move onto the extraction phase.

